# Configuring Roaming Profiles for Users with GPO

- Go to Server Manager and on the left side is an option **File and Storage Services**.
- Open Shares.
- Right click in the middle and select New Share.
- Now select the type of Share:
  - SMB Share - Quick
  - SMB Share - Advanced
  - SMB Share - Applications
  - NFS Share - Quick
  - NFS Share - Advanced
- Lets go with **SMB Share - Quick** and in Share Location select your server and then your volume (C or E drive) or enter your custom path. We will go with C drive.
- Next give the share a name and/or a description.
- Enter a name (Profile$). The $ symbol makes sure the folder stays hidden if someone were to open the local path where this folder exists.
- Enable **access-based enumeration**. This will display only files and folders that a user has permissions to access.
- To have more security, encrypt the share.
- In Permissions, hit customize permissions.
- It is recommended to remove users from this. First, **Disable Inheritance**. This will give a pop up and we can choose whether we want to:
  - Convert these inherited permissions into explicit permissions on this object. (This sets up a new set of permissions just for this share)
  - Remove all inherited permissions from this object.
- Go with the first option and Remove users now.
- Next create a new group in AD and name it **Roaming Profiles**. Then we will give this group access to this file share.
- Open run and enter **`dsa.msc`**. Here in ADUC, go to your OU and create a new sub-OU named Domain Groups and create a new Global security group named "**Roaming Profile Users**". Add users to this group.
- Now go back to **Share Wizard** and click ADD. Click Select Principal and add the above group. Uncheck all permissions.
- Click Show Advanced Permissions and give permissions to the account such as:
  - List Folder/read data
  - Create Folders/append data
- You can choose where these permissions apply. Here it should apply to only this folder. Same for Administrator.
- Finally, create this share.
- **Now go back to ADUC and open properties of the group and open its users one by one and in Properties -> Profile, enter the Network Path of the file share (\\\server-name\folder$\%username%).**
- Close and login with this userid on a different member server. Next search for User Profiles and there we will see this user listed as **Roaming**.
- If we create a folder on Desktop and a file inside it and the sign out and login to a different server with the same id, we will be able to see our folder right there on the desktop even though we created it on other server.
